generator client {
  provider   = "prisma-client-js"
  engineType = "library"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model accounts {
  id                  String  @id
  user_id             String
  type                String
  provider            String
  provider_account_id String
  refresh_token       String?
  access_token        String?
  expires_at          Int?
  token_type          String?
  scope               String?
  id_token            String?
  session_state       String?
  users               users   @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([provider, provider_account_id])
}

model actions_correctives {
  id                             String                           @id
  titre                          String
  description                    String
  statut                         String                           @default("planifiee")
  origine_type                   String
  origine_ref                    String?
  origine_date                   DateTime?
  origine_resume                 String?
  priorite                       String                           @default("moyenne")
  avancement                     Int                              @default(0)
  responsable_nom                String?
  responsable_email              String?
  date_echeance                  DateTime?
  indicateur_efficacite          String?
  reclamation_id                 String?
  created_at                     DateTime                         @default(now())
  updated_at                     DateTime                         @default(now())
  reclamations                   reclamations?                    @relation(fields: [reclamation_id], references: [id])
  historique_actions_correctives historique_actions_correctives[]
}

model apprenants {
  id                 String               @id
  nom                String
  email              String
  telephone          String?
  created_at         DateTime             @default(now())
  dossiers_formation dossiers_formation[]
}

model categories_programme {
  id                   String                 @id
  code                 String                 @unique
  titre                String
  description          String
  ordre                Int                    @default(0)
  created_at           DateTime               @default(now())
  updated_at           DateTime               @default(now())
  programmes_formation programmes_formation[]
}

model competences {
  id                    String   @id
  nom                   String
  description           String
  categorie             String
  domaine_developpement String
  niveau_actuel         Int
  objectif_niveau       Int
  statut                String
  action_prevue         String
  plateforme_formation  String?
  lien_formation        String?
  type_preuve           String
  contenu_preuve        String
  date_creation         DateTime @default(now())
  date_modification     DateTime @default(now())
  formateur_id          String?
}

model conformite_qualiopi {
  id                 String   @id
  indicateur         String
  description        String
  statut_conformite  String
  date_verification  DateTime
  prochaine_echeance DateTime
  element_preuve     String?
  commentaire        String?
}

model demandes_accessibilite {
  id              String    @id
  nom             String
  email           String
  telephone       String?
  description     String
  date_creation   DateTime  @default(now())
  statut          String    @default("nouvelle")
  reponse         String?
  date_resolution DateTime?
}

model documents_formation {
  id                   String             @id
  dossier_formation_id String
  nom                  String
  type                 String
  url                  String
  date_creation        DateTime           @default(now())
  dossiers_formation   dossiers_formation @relation(fields: [dossier_formation_id], references: [id])
}

model dossiers_formation {
  id                      String                   @id
  apprenant_id            String
  positionnement_id       String?                  @unique
  date_inscription        DateTime                 @default(now())
  date_debut              DateTime?
  date_fin                DateTime?
  created_at              DateTime                 @default(now())
  updated_at              DateTime                 @default(now())
  programme_formation_id  String?
  statut                  String                   @default("inscrit")
  formation_id            String
  documents_formation     documents_formation[]
  apprenants              apprenants               @relation(fields: [apprenant_id], references: [id])
  formations              formations               @relation(fields: [formation_id], references: [id])
  positionnement_requests positionnement_requests? @relation(fields: [positionnement_id], references: [id])
  programmes_formation    programmes_formation?    @relation(fields: [programme_formation_id], references: [id])
  rendezvous              rendezvous[]
}

model formations {
  id                       String                     @id
  duree                    String
  prerequis                String
  tarif                    String
  date_creation            DateTime                   @default(now())
  date_modification        DateTime                   @default(now())
  created_at               DateTime                   @default(now())
  accessibilite_handicapee String                     @default("Formation accessible aux personnes en situation de handicap. Contactez notre référent handicap pour adapter le parcours.")
  delai_acceptation        String                     @default("7 jours ouvrables")
  formateur                String                     @default("Formateur spécialisé WordPress avec 5+ ans d'expérience")
  horaires                 String                     @default("9h-12h30 et 14h-17h30, adaptables selon les besoins du bénéficiaire")
  modalites_acces          String                     @default("Formation accessible à distance ou en présentiel selon le contexte")
  niveau_certification     String                     @default("Formation non certifiante")
  objectifs_pedagogiques   String
  referent_pedagogique     String                     @default("Aurélien Lien - aurelien@gestionmax.fr")
  referent_qualite         String                     @default("Aurélien Lien - aurelien@gestionmax.fr")
  ressources_disposition   String                     @default("Support de cours, tutoriels vidéo, accès à une plateforme d'exercices")
  code                     String
  libelle                  String
  contenu_detaille_jours   String?
  cessation_abandon        String
  contact_organisme        String                     @default("GestionMax - aurelien@gestionmax.fr - 01.23.45.67.89")
  modalites_evaluation     String
  modalites_reglement      String
  public_concerne          String
  sanction_formation       String
  modalitesTechniques      String                     @default("Formation en présentiel individuel")
  dossiers_formation       dossiers_formation[]
  programmes_personnalises programmes_personnalises[]
}

model historique_actions_correctives {
  id                   String              @id
  action_corrective_id String
  date_action          DateTime            @default(now())
  action               String
  utilisateur          String
  commentaire          String?
  created_at           DateTime            @default(now())
  actions_correctives  actions_correctives @relation(fields: [action_corrective_id], references: [id])
}

model plans_accessibilite {
  id                String   @id
  titre             String
  description       String
  date_creation     DateTime @default(now())
  date_modification DateTime @default(now())
  actions_requises  String[]
  statut            String   @default("actif")
}

model positionnement_requests {
  id                       String                    @id
  formation_selectionnee   String?
  nom_beneficiaire         String
  prenom_beneficiaire      String
  statut                   String                    @default("nouveau")
  created_at               DateTime                  @default(now())
  updated_at               DateTime                  @default(now())
  adresse_entreprise       String?
  entreprise               String?
  interlocuteur_email      String?
  interlocuteur_fonction   String?
  interlocuteur_nom        String?
  interlocuteur_telephone  String?
  organisme_financeur      String?
  siret                    String?
  type_financement         String?
  attentes                 String
  besoin_handicap          String?
  commentaires             String?
  date_contact             DateTime?
  date_debut_souhaitee     DateTime?
  date_dispo               String
  date_fin_souhaitee       DateTime?
  date_rdv                 DateTime?
  details_handicap         String?
  email_beneficiaire       String
  has_handicap             Boolean                   @default(false)
  is_financement           Boolean                   @default(false)
  modalite_formation       String?
  niveau_beneficiaire      String?
  objectifs                String[]
  pratique_actuelle        String
  situation_actuelle       String
  telephone_beneficiaire   String?
  dossiers_formation       dossiers_formation?
  programmes_formation     programmes_formation?
  programmes_personnalises programmes_personnalises?
}

model programmes_formation {
  id                         String                   @id
  code                       String
  type                       String
  version                    Int                      @default(1)
  est_actif                  Boolean                  @default(true)
  est_visible                Boolean                  @default(true)
  categorie_id               String?
  pictogramme                String?
  titre                      String
  description                String
  duree                      String
  prix                       String
  niveau                     String
  participants               String
  objectifs                  String[]
  objectifs_specifiques      String?
  prerequis                  String
  public_concerne            String
  contenu_detaille_jours     String
  evaluation_sur             String?
  horaires                   String                   @default("9h-12h30 et 14h-17h30")
  modalites                  String
  modalites_acces            String
  modalites_techniques       String
  delai_acces                String?
  modalites_reglement        String
  contact_organisme          String                   @default("GestionMax - aurelien@gestionmax.fr - 06.46.02.24.68")
  referent_pedagogique       String                   @default("Aurélien Lien - aurelien@gestionmax.fr")
  referent_qualite           String                   @default("Aurélien Lien - aurelien@gestionmax.fr")
  formateur                  String
  ressources_disposition     String
  modalites_evaluation       String
  sanction_formation         String
  niveau_certification       String
  delai_acceptation          String
  accessibilite_handicap     String
  cessation_abandon          String
  programme_url              String?
  ressources_associees       String[]
  date_creation              DateTime                 @default(now())
  date_modification          DateTime                 @default(now())
  beneficiaire_id            String?
  formateur_id               String?
  positionnement_request_id  String?                  @unique
  programme_source_id        String?
  type_programme             String?
  dossiers_formation         dossiers_formation[]
  categories_programme       categories_programme?    @relation(fields: [categorie_id], references: [id])
  positionnement_requests    positionnement_requests? @relation(fields: [positionnement_request_id], references: [id])
  programmes_formation       programmes_formation?    @relation("programmes_formationToprogrammes_formation", fields: [programme_source_id], references: [id])
  other_programmes_formation programmes_formation[]   @relation("programmes_formationToprogrammes_formation")
  rendezvous                 rendezvous[]
}

model programmes_personnalises {
  id                        String                   @id
  titre                     String
  description               String
  contenu                   String
  duree                     String
  objectifs_specifiques     String
  evaluation_sur            String
  created_at                DateTime                 @default(now())
  updated_at                DateTime                 @default(now())
  accessibilite_handicap    String?
  cessation_anticipee       String?
  delai_acceptation         String?
  delai_acces               String?
  formateur                 String?
  horaires                  String?
  modalites_acces           String?
  modalites_evaluation      String?
  modalites_reglement       String?
  modalites_techniques      String?
  niveau_certification      String?
  prerequis                 String?
  public_concerne           String?
  referent_pedagogique      String?
  referent_qualite          String?
  ressources_disposition    String?
  sanction_formation        String?
  tarif                     String?
  positionnement_request_id String?                  @unique
  formation_id              String
  formations                formations               @relation(fields: [formation_id], references: [id])
  positionnement_requests   positionnement_requests? @relation(fields: [positionnement_request_id], references: [id])
  rendezvous                rendezvous[]
}

model reclamations {
  id                  String                @id
  nom                 String
  email               String
  telephone           String?
  sujet               String
  message             String
  statut              String                @default("nouvelle")
  priorite            String                @default("normale")
  assignee_id         String?
  notes_internes      String?
  date_resolution     DateTime?
  created_at          DateTime              @default(now())
  updated_at          DateTime              @default(now())
  actions_correctives actions_correctives[]
  users               users?                @relation(fields: [assignee_id], references: [id])
}

model rendezvous {
  id                        String                    @id
  type                      String
  status                    String
  prenom                    String
  nom                       String
  email                     String
  telephone                 String?
  objectifs                 String?
  competences_actuelles     String?
  niveau                    String?
  format_souhaite           String?
  disponibilites            String?
  commentaires              String?
  date_rdv                  DateTime?
  duree_rdv                 Int?
  format_rdv                String?
  lieu_rdv                  String?
  lien_visio                String?
  notes                     String?
  synthese                  String?
  formation_titre           String?
  formation_selectionnee    String?
  situation_actuelle        String?
  attentes                  String?
  pratique_actuelle         String?
  is_financement            Boolean?                  @default(false)
  type_financement          String?
  organisme_financeur       String?
  has_handicap              Boolean?                  @default(false)
  details_handicap          String?
  besoin_handicap           String?
  entreprise                String?
  siret                     String?
  adresse_entreprise        String?
  interlocuteur_nom         String?
  interlocuteur_fonction    String?
  interlocuteur_email       String?
  interlocuteur_telephone   String?
  date_contact              DateTime?
  date_debut_souhaitee      DateTime?
  date_fin_souhaitee        DateTime?
  created_at                DateTime                  @default(now())
  updated_at                DateTime                  @default(now())
  formation_id              String?
  dossier_formation_id      String?
  programme_personnalise_id String?
  ameliorations_suggerees   String?
  commentaires_impact       String?
  competences_appliquees    String?
  date_impact               DateTime?
  rendezvous_parent_id      String?
  satisfaction_impact       Int?
  competences_recherchees   String?
  dossiers_formation        dossiers_formation?       @relation(fields: [dossier_formation_id], references: [id], map: "rendezvous_dossier_formation_fkey")
  programmes_formation      programmes_formation?     @relation(fields: [formation_id], references: [id], map: "rendezvous_formation_fkey")
  programmes_personnalises  programmes_personnalises? @relation(fields: [programme_personnalise_id], references: [id], map: "rendezvous_programme_personnalise_fkey")
  rendezvous                rendezvous?               @relation("rendezvousTorendezvous", fields: [rendezvous_parent_id], references: [id])
  other_rendezvous          rendezvous[]              @relation("rendezvousTorendezvous")
}

model sessions {
  id            String   @id
  session_token String   @unique
  user_id       String
  expires       DateTime
  users         users    @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

model users {
  id             String         @id
  clerkId        String?        @unique
  email          String?        @unique
  password       String?
  nom            String?
  prenom         String?
  role           String         @default("user")
  created_at     DateTime       @default(now())
  updated_at     DateTime       @default(now())
  email_verified DateTime?
  image          String?
  name           String?
  accounts       accounts[]
  reclamations   reclamations[]
  sessions       sessions[]
}

model veilles {
  id            String    @id
  titre         String
  description   String
  type          String
  statut        String    @default("nouvelle")
  avancement    Int       @default(0)
  date_creation DateTime  @default(now())
  date_echeance DateTime?
}

model verification_tokens {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}
